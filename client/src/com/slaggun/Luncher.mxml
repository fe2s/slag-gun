<?xml version="1.0" encoding="utf-8"?>
<mx:Application layout="absolute"
                initialize="initApp();"
                enterFrame="enterFrame()"

                mouseDown ="mouseDown(event)"
                mouseUp   ="mouseUp(event)"
                mouseMove ="mouseMove(event)"

                applicationComplete="hookKeyboard()"

                resize = "resize()"
                
                xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
<![CDATA[
        import com.slaggun.actor.world.InputState;

        import mx.core.Application;

        private var luncher:LuncherClass

        private function enterFrame():void{
            luncher.enterFrame(output.graphics)            
        }

        private function hookKeyboard():void {
            stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDown);
            stage.addEventListener(KeyboardEvent.KEY_UP, keyUp);
        }

        private function initApp():void {
            luncher = new LuncherClass()
            luncher.resize(Application.application.width, Application.application.height);
            luncher.inititalize()
        }

        private function getButtonConst(leftMouseButton:Boolean):Number{
            if(leftMouseButton){
                return InputState.MOUSE_LEFT
            }else{
                return InputState.MOUSE_RIGHT
            }
        }

        private function keyDown(event:KeyboardEvent):void{
            luncher.buttonDown(event.keyCode);
        }

        private function keyUp(event:KeyboardEvent):void{
            luncher.buttonUp(event.keyCode);
        }

        private function mouseDown(event:MouseEvent):void{
            luncher.buttonDown(getButtonConst(event.buttonDown));
            luncher.mouseMove(event.localX, event.localY)
        }

        private function mouseUp(event:MouseEvent):void{
            luncher.buttonUp(getButtonConst(event.buttonDown));
            luncher.mouseMove(event.localX, event.localY)
        }

        private function mouseMove(event:MouseEvent):void{
            luncher.mouseMove(event.localX, event.localY)
        }

        private function resize():void{
            if(output != null)
                luncher.resize(output.width, output.height);
        }

]]>
</mx:Script>

    <mx:Canvas id="output" x = "0" y = "0" width = "100%" height = "100%"/>

</mx:Application>